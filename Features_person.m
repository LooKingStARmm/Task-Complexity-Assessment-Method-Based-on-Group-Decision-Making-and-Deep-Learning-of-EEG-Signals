%% 用来获得两条曲线之间的皮尔逊相关性系数,研究同一参试者用时和表现得分与特征的关系
datas=feature_all_10hao(:,2:end-1);
% data = normalize(data1);%归一化
%% 代码用来获得六种波形共109列特征的名字
Delta={'FC','max_val', 'min_val', 'mean_val', 'std_val', 'rms_val', 'renyi','renyi_entropy','log_energy_entropy','shannon_entropy','tsallis_entropy','log_root_mean_square','teager_energy','kurtosis','skewness','complexity','hjorth_mobility','hjorth_activity';'Delta','Delta','Delta','Delta','Delta','Delta','Delta','Delta','Delta','Delta','Delta','Delta','Delta','Delta','Delta','Delta','Delta','Delta'};
Theta={'FC','max_val', 'min_val', 'mean_val', 'std_val', 'rms_val', 'renyi','renyi_entropy','log_energy_entropy','shannon_entropy','tsallis_entropy','log_root_mean_square','teager_energy','kurtosis','skewness','complexity','hjorth_mobility','hjorth_activity';'Theta','Theta','Theta','Theta','Theta','Theta','Theta','Theta','Theta','Theta','Theta','Theta','Theta','Theta','Theta','Theta','Theta','Theta'};
Alpha={'FC','max_val', 'min_val', 'mean_val', 'std_val', 'rms_val', 'renyi','renyi_entropy','log_energy_entropy','shannon_entropy','tsallis_entropy','log_root_mean_square','teager_energy','kurtosis','skewness','complexity','hjorth_mobility','hjorth_activity';'Alpha','Alpha','Alpha','Alpha','Alpha','Alpha','Alpha','Alpha','Alpha','Alpha','Alpha','Alpha','Alpha','Alpha','Alpha','Alpha','Alpha','Alpha'};
BETA={'FC','max_val', 'min_val', 'mean_val', 'std_val', 'rms_val', 'renyi','renyi_entropy','log_energy_entropy','shannon_entropy','tsallis_entropy','log_root_mean_square','teager_energy','kurtosis','skewness','complexity','hjorth_mobility','hjorth_activity';'DETA','DETA','DETA','DETA','DETA','DETA','DETA','DETA','DETA','DETA','DETA','DETA','DETA','DETA','DETA','DETA','DETA','DETA'};
Gamma={'FC','max_val', 'min_val', 'mean_val', 'std_val', 'rms_val', 'renyi','renyi_entropy','log_energy_entropy','shannon_entropy','tsallis_entropy','log_root_mean_square','teager_energy','kurtosis','skewness','complexity','hjorth_mobility','hjorth_activity';'Gamma','Gamma','Gamma','Gamma','Gamma','Gamma','Gamma','Gamma','Gamma','Gamma','Gamma','Gamma','Gamma','Gamma','Gamma','Gamma','Gamma','Gamma'};
Rawdata={'delta_avg_power','theta_avg_power','alpha_avg_power','beta_avg_power','gamma_avg_power','FC','max_val', 'min_val', 'mean_val', 'std_val', 'rms_val', 'renyi','renyi_entropy','log_energy_entropy','shannon_entropy','tsallis_entropy','log_root_mean_square','teager_energy','kurtosis','skewness','complexity','hjorth_mobility','hjorth_activity','ZB_DE','ZB_TH','ZB_AL','ZB_BE','ZB_GA';'p','p','p','p','p','Rawdata','Rawdata','Rawdata','Rawdata','Rawdata','Rawdata','Rawdata','Rawdata','Rawdata','Rawdata','Rawdata','Rawdata','Rawdata','Rawdata','Rawdata','Rawdata','Rawdata','Rawdata','p','p','p','p','p'};
featureName_cell=horzcat(Delta,Theta,Alpha,BETA,Gamma,Rawdata);
%9hao
%{
score1=[];
score2=[7.228297954	8.750831516	6.847019331	7.826936678	5.817136492	6.860220585	8.435978036	7.867320641	8.029882772	8.340555986	6.97225442	8.303632841	8.273223952	7.602761418	7.566709309	8.369699746	8.118299055	5.237261983];
step_time1=[];
step_time2=[45	07	23	27	38	25	24	27	33	08	51	10	07	30	23	02	39	86];
%}
%7hao
%{
score1=[8.186530272	8.746943103	8.066439892	8.176519659	8.561603065	8.265048571	8.556503319	5.605199158	8.540342898	8.521575971	8.495699906	9.063393977	7.367086715];
score2=[8.068504769	2.191780677	9.603208829	8.250970864	8.357241038	7.835984006	8.580548325	8.442382331	9.091979968	8.614234957	7.993931137	8.504260786	8.581884694	8.078551115	10.35271829	6.446711135	8.343116774	9.452461324];
step_time1=[25	07	13	12	18	13	17	07	07	23	09	18	41];
step_time2=[30	58	06	23	39	20	26	11	11	06	30	08	05	18	05	26	36	22];
%}
%11hao
%{
score1=[7.799180532	7.159039816	4.869267783	7.53546293	5.354257589	6.81239709	7.661417735	7.241791741	7.174543006	7.601810253	3.778656501	6.503753646	7.594645797];
score2=[7.56438068	7.429042411	5.409155597	3.418208194	5.693697807	7.250525953	7.713126588	6.181236171	8.222991353	8.477395471	7.945279865	8.604574759	7.96456321	7.563112276	7.566709309	8.049201644	8.268177535	8.604083164];
step_time1=[38	15	107	20	42	20	21	14	15	45	63	35	78];
step_time2=[39	26	56	45	72	23	29	11	29	07	31	07	09	31	23	06	37	41];
%}
%6hao
%{
score1=[1.459258437	5.14038876	4.163448236	5.131500196	6.824290932	4.944702328	2.547060123	4.842144604	5.638018128	2.135853772	5.825556156	6.356553297];
score2=[7.188478577	8.542127973	6.10630165	8.082584241	6.582492966	6.665067901	8.146837457	7.975144708	4.469575927	8.203716501	3.724838288	3.596550329	6.884250614	7.40451571	8.185822416	0	2.521870858	5.237261983];
step_time1=[165	10	115	50	31	29	27	26	24	72	21	46];
step_time2=[43	10	40	01	48	26	26	24	82	09	89	44	16	35	19	55	77	86];
%}
%5hao
%{
score1=[6.176304271	6.960551905	7.070916401	8.096387568	8.027045486	8.057526931	8.108960527	8.039218931	7.003818019	8.145308177	7.7725663	8.611692742	7.368327755];
score2=[7.076451002	8.194288735	9.428922316	8.038953771	7.388679863	7.835984006	6.267423693	5.929646682	5.640429315	3.903862854	8.285838771	6.999551199	6.729920243	8.118200257	7.102374479	7.648579017	4.245473374	8.73803761];
step_time1=[41	16	23	13	22	14	19	09	16	32	22	21	47];
step_time2=[15	15	10	25	51	20	39	18	33	22	24	23	17	17	26	11	54	38];
%}
%4hao
%{
score1=[8.156734138	8.548455192	7.070916401	7.695727112	8.294324276	7.64248365	5.705183249	8.641585904	8.540342898	8.479768438	8.440074244	7.557723194	8.550235496];
score2=[4.015071614	8.542127973	9.559637201	5.622572436	7.953673882	8.811747427	7.13484543	8.370499619	7.691942756	8.477395471	4.223525087	3.704538497	5.10780297	5.146758788	4.350952149	7.969077119	6.994210458	6.558846425];
step_time1=[26	08	23	18	20	16	23	07	07	24	10	28	20];
step_time2=[79	10	07	36	44	15	33	13	40	07	73	30	08	16	29	07	54	26];
%}
%3hao
%{
score1=[7.918365067	6.563576084	6.786490168	7.936123386	5.433683934	5.196126521	5.423703774	6.436998985	7.003818019	6.049500767	7.21630968	5.600351176	8.645230456];
score2=[7.676408255	7.846449497	7.914637828	5.728580983	7.711533588	0.785588117	6.556564272	6.870046501	7.836774191	6.698482162	7.750674776	7.300493116	4.260634308	7.91995455	4.041395595	7.408205441	6.394117565	8.023613896];
step_time1=[34	18	32	15	29	13	31	16	16	28	32	41	54];
step_time2=[37	20	17	35	47	35	37	17	37	20	35	20	33	22	31	14	40	54];
%}
%2hao
%{
score1=[7.739588264	8.349967281	7.592396169	8.176519659	5.973284172	8.265048571	8.108960527	8.441615309	7.686717965	8.521575971	7.883817624	8.159991507	7.893620084];
score2=[9.188780522	7.150771021	8.252488351	8.038953771	5.736423061	8.421442058	5.758575305	1.904214853	6.021765716	6.734322172	5.245246837	5.510190002	4.490481487	8.356095106	7.721487586	7.888952593	7.443266922	6.573214442];
step_time1=[40	09	28	12	20	13	19	08	12	23	20	24	35];
step_time2=[10	30	37	25	39	17	14	130	35	05	29	12	12	11	22	08	26	50];
%}
%20hao
%{
score1=[8.156734138	7.754503549	7.629276794	8.016255477	7.358848512	7.037479751	7.885189131	8.441615309	7.686717965	8.228923243	8.05069461	5.155726348	7.450912317];
score2=[7.78843583	8.542127973	6.454874676	6.386447496	8.599381331	7.835984006	7.423986009	7.049753279	6.026646477	6.698482162	7.264162054	5.669157519	8.581884694	7.523463135	7.411931032	7.808828068	6.544575019	8.380825753];
step_time1=[26	12	34	14	27	13	20	08	12	30	17	31	21];
step_time2=[35	10	32	17	36	20	31	12	25	20	45	13	05	32	24	09	60	46];
%}
%1hao
%{
score1=[8.007753469	6.166600262	8.830250905	7.295066656	6.557012143	6.81239709	7.437646339	7.841703525	6.833093033	7.601810253	7.828191962	8.611692742	6.187661053];
score2=[7.844449618	8.194288735	9.385350687	8.144962318	7.307966432	9.006900111	7.423986009	8.082968774	7.112617013	6.972161133	8.139884954	7.902376951	7.810232839	7.325217427	8.495378969	7.648579017	7.668663616	4.921109603];
step_time1=[31	20	39	23	33	20	22	11	17	45	21	21	80];
step_time2=[34	15	11	24	52	14	31	21	52	18	27	14	10	37	17	11	45	87];
%}
%17hao
%{
score1=[8.275918673	8.548455192	9.241088798	8.176519659	8.427963671	9.21236992	7.437646339	8.241644714	8.88179287	8.437960906	8.495699906	8.461125664	9.345620229];
score2=[9.132766735	8.263856583	8.644633006	7.508911038	8.034387313	8.50525953	8.291407746	8.442382331	8.367822789	8.614234957	8.431792587	8.704888731	7.655902468	8.316445964	7.566709309	8.12932617	8.492995254	8.380825753];
step_time1=[59	67	93	105	124	132	154	163	168	193	202	224	262];
step_time2=[11	14	28	30	43	23	25	11	26	06	21	06	11	12	23	05	34	46];
%}
%16hao
%{
score1=[8.156734138	5.934340403	9.304294628	8.016255477	8.160684881	8.057526931	5.481411852	6.041968172	8.028167938	3.70827894	7.716940638	6.804887802	5.746194326];
score2=[7.78843583	2.748323458	8.775347891	7.508911038	8.034387313	6.860220585	7.279415719	8.011086063	8.512654225	8.477395471	8.626397676	7.200179144	7.96456321	7.682059701	7.721487586	7.728703542	7.968420575	5.263953443];
step_time1=[26	06	24	14	21	14	24	20	10	84	23	33	72];
step_time2=[35	50	25	30	43	25	32	23	23	07	17	21	09	28	22	10	41	55];
%}
%15hao
%{
score1=[7.948161201	7.95299146	6.976107657	8.577180115	8.561603065	7.850005291	9.675360299	7.841703525	3.905062313	8.103500645	8.217571596	8.009424429	7.149455951];
score2=[7.116270378	7.150771021	7.021305844	7.720928132	7.630820157	7.250525953	6.845704851	8.11891013	8.65748566	8.340555986	8.626397676	8.403946814	8.118893581	7.999252832	7.876265862	7.969077119	9.092509173	8.380825753];
step_time1=[33	11	26	07	18	15	12	11	10	33	14	25	52];
step_time2=[47	30	19	28	48	23	35	20	20	08	17	09	08	20	21	07	26	46];
%}
%14hao
%{
score1=[5.630717173	8.349967281	6.34404936	3.973281942	5.914028463	8.057526931	8.332731923	7.64173293	8.540342898	7.309157525	5.473393492	5.825556156	7.62600976];
score2=[7.844449618	7.081203173	6.193444906	7.826936678	8.841521625	7.250525953	7.713126588	5.678057192	8.029882772	6.050124745	8.772351493	8.604574759	7.655902468	7.840656267	8.804935523	7.728703542	8.567934494	8.961295021];
step_time1=[25	09	46	13	13	14	18	12	07	52	12	21	17];
step_time2=[34	31	38	27	33	23	29	25	33	10	14	07	11	24	15	10	33	33];
%}
%12hao
%{
score1=[5.975686884	5.372648619	6.912901827	6.173217381	7.759766696	6.631216981	7.213874943	5.005287373	7.174543006	7.267349992	8.161945934	6.202619489	4.036512175];
score2=[4.834837987	8.194288735	4.145578375	7.848751913	2.85068104	7.640831322	5.544572245	8.226734197	2.985186326	2.809146971	5.001990476	8.303632841	7.810232839	0.94394979	6.982182853	6.847333762	6.694453498	4.835398643];
step_time1=[22	24	28	37	24	12	23	10	15	53	15	37	99];
step_time2=[41	15	85	15	78	21	44	17	88	30	34	10	10	122	12	21	58	95];
%}
%10hao
%
score1=[8.454695476	7.556015638	9.272691713	5.45202856	8.427963671	8.265048571	8.780274715	8.041674119	8.88179287	8.688806101	8.384448582	8.461125664	8.426358652];
score2=[6.515251617	8.05515304	5.278440712	7.826936678	8.841521625	9.006900111	7.713126588	8.406440975	8.367822789	8.477395471	8.821002765	8.203318869	8.118893581	8.19749854	7.721487586	8.28957522	8.268177535	7.577099075];
step_time1=[16	13	25	46	19	13	16	10	05	19	11	22	59];
step_time2=[11	17	59	27	33	14	29	12	26	07	13	11	08	15	22	03	37	64];
%}






score=[score1,score2];
step_time=[step_time1,step_time2];
% score= normalize(score1);归一化
% bad_cols = any(isnan(datas) | isinf(datas));
% % any函数用于判断一个矩阵中有没有非零元素，isinf和isnan函数分别返回矩阵A中是否包含inf或nan的逻辑数组
% 
% % 输出要删除的列的序号
% bad_col_indexes = find(bad_cols);
% fprintf('要删除的列的序号为：\n');
% disp(bad_col_indexes);
bad_cols=[10    28    46    64    82   100];
datas(:, bad_cols) = [];
featureName_cell(:, bad_cols)=[];
feature_cell=num2cell(datas);
features_cell=vertcat(featureName_cell,feature_cell);%里面保存带有特征名字的特征集

% 计算107条曲线数据与得分曲线之间的皮尔逊相关系数
%% 对不同表现参数的结合
% data2=[datas,score'];%第108列是得分
data2=[datas,step_time'];

corr_coef = corrcoef(data2(:,86:end));%获得的是列与列之间的相关性
selected_corrs = corr_coef(abs(corr_coef) > 0.2);


% 获取最后31行107列数据，即107条曲线数据与得分曲线之间的相关系数
corr_values = corr_coef(end,1:end-1);
corr_values_max=max(corr_values)
%

% 对第一行进行排序，并保存排序后每个元素的下标
[sorted_row, indices] = sort(corr_values,'descend');
corr_values_Down=[sorted_row; indices]';%保存相关性的值到第一行，对应的特征的列号为第二行,降序排列
%将相关性最高的特征与得分画在一张图
%
subplot(3,1,1);
plot(data2(:,end));
xlabel('步骤');  % 设置横轴标签为时间
ylabel('值');  % 设置纵轴标签为幅值
title('得分');  % 设置图标题
subplot(3,1,2)
plot(data2(:,indices(1,1)));
xlabel('步骤');  % 设置横轴标签为时间
ylabel('值');  % 设置纵轴标签为幅值
title('步骤对应特征值');  % 设置图标题
subplot(3,1,3)
plot(data2(:,indices(1,2)));
xlabel('步骤');  % 设置横轴标签为时间
ylabel('值');  % 设置纵轴标签为幅值
title('步骤对应特征值');  % 设置图标题
%}
corr_coef = corrcoef(Feature_deltaPSD_12People);

